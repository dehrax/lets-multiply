<html>
	<head>
	<title>Let's Multiply! - Train your multiplication skills!</title>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<link rel="manifest" href="manifest.json">
		<link rel="stylesheet" type="text/css" href="style.css"/>
	</head>
	<body>
		<h1>Let's Multiply!</h1>
		<div id="content">
			<div id="display"></div>

			<input id="input" type="tel" onkeydown="validateInput(event)">
			
			<div class="explosion">
				<div class="particle"></div>
				<div class="particle"></div>
				<div class="particle"></div>
				<div class="particle"></div>
				<div class="particle"></div>
				<div class="particle"></div>
				<div class="particle"></div>
				<div class="particle"></div>
			</div>
		</div>
		
		<div class="calc-container">
			<!--
			<div>1</div>
			<div>2</div>
			<div>3</div>
			<div>4</div>
			<div>5</div>
			<div>6</div>
			<div>7</div>
			<div>8</div>
			<div>9</div>
			<div>0</div>
			<div class="enter">Enter</div>
		-->
		</div>
		
		<script>

			var input = document.querySelector('#input');

			var display = document.querySelector('#display');

			var content = document.querySelector('#content');

			//Explosion particles
			var particles = document.querySelectorAll(".particle");

			//console.log(input);

			generateNumbers();
			//Values to multiply, the multiplied answer
			var m1, m2 = 0;
			var answer;
			var tries = 0; //amount of tries
			var ANIMATION_LENGTH = 300;//milliseconds


			//Generate new numbers
			function generateNumbers(){
				m1 = Math.round(Math.random()*10);//from 0-10
				m2 = Math.round(Math.random()*10);
				//console.log(m1, m2);
				answer = m1 * m2;
				//console.log(answer);
				display.innerHTML = m1 + ' 	&#215; ' + m2;
			}
			function validateInput(event){
				//event.preventDefault();
				//event.stopPropagation();
				if(event.key == 'Enter' || event.keyCode == 9){
					event.preventDefault();
					input.focus();
					console.log('Validating input...');

					console.log('Input value: ' + input.value);

					console.log('Answer: ' + answer);
					if(input.value == answer){
						console.log('Correct!');
						putText('Success!', 'green');
						generateNumbers();
					}else{
						putText('Fail!', 'red');
						console.log('Incorrect!');
					}
					tries++;
					input.value = '';
				}
				
			}

			function putText(text, color){
				var el = document.createElement('span');
				el.id = 'annotation-' + tries;
				el.className = 'annotation'
				el.style.color = color;
				el.innerHTML = text;
				content.appendChild(el);
				setTimeout(function(){
					content.removeChild(el);
				}, ANIMATION_LENGTH);
			}

			function initParticles(){
				//console.log("Initianting particles");
				//var particles = document.querySelectorAll(".particle");
				particles.forEach((particle, index) => {
					particle.style.transform = "rotate(" + (360 / particles.length) * (index + 1)  + "deg)";
					console.log(particle.style.transform);
				});
			}
			initParticles();

			function explode(duration){
				
				var length = duration ? duration : 400;

				particles.forEach((particle, index)=>{
				
					particle.style.transform = "rotate(" + (360 / particles.length) * (index)  + "deg)";
					particle.style.opacity = "1"
					particle.style.transition = "all 0." + length + "s ease-out";
					particle.style.transform = "rotate(" + (360 / particles.length) * (index)  + "deg) translate(300%)";
					particle.style.opacity = "0"
					//console.log(particle.style.transform);
				});

				setTimeout(()=>{
					//Reset
					particles.forEach((particle, index)=>{
						// Turn off transitions
						particle.style.transition = "";
						// Reset particle
						particle.style.transform = "rotate(" + (360 / particles.length) * (index)  + "deg)";
					});
				}, length);
			}
			//explode();
		</script>

	</body>
</html>
